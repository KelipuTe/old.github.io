---
title: "分布式系统 CAP 理论"
create_date: 2022-05-05 08:00:00 +0800
date: 2022-05-05 08:00:00 +0800
tags: computer-science distributed-system
comment: false
show_author_profile: true
show_subscribe: false
---

### CAP 理论

CAP 理论是指：是在一个分布式系统中，一致性、可用性、分区容错性，这三者无法最多同时满足两个。

- 一致性（Consistency）：系统在执行过某项操作后仍然处于一致的状态。比如，更新操作执行成功后，所有的用户都能读到最新的值。
- 可用性（Availability）：每一个操作总是能够在一定的时间内（可以容忍的时间内）返回结果，结果可以是成功或者失败。
- 分区容错性（Partition-Tolerance）：在存在网络分区的情况下，仍然可以接受请求。

其中网络分区指的是：在一个分布式系统中，节点组成的网络本来应该是连通的。然而可能因为一些故障，使得有些节点之间不连通了，整个网络就分成了几块区域，而数据被动的散布在了这些不连通的区域中。

当某一个数据项只在一个节点中保存，那么分区出现后，和这个节点不连通的部分就访问不到这个数据了。提高分区容错性的办法就是将数据项复制到多个节点上。然而，要把数据项复制到多个节点上，就会带来一致性的问题。如果要保证一致，那么每次写操作就都要等待全部节点写成功，而这又会带来可用性的问题。

### CP、AP

首先分区容错性是一定要保证的。在分布式系统由于网络硬件肯定会出现延迟丢包等问题，想要避免分区容错性就意味着单体部属，单体部属一定严重影响系统的扩展性。所以只能在一致性和可用性之间进行权衡。

选择一致性意味着，放弃可用性。一旦遇到分区容错性故障，那么受到影响的服务就需要一直等到节点间的网络通信重新连上，因此在等待期间系统无法对外提供服务。

选择可用性意味着，放弃一致性。这里的放弃一致性，并不是完全放弃数据一致性，而是放弃数据的强一致性，而保留数据的最终一致性。等到节点间的网络通信重新连上后，数据就会恢复一致性。

### 参考

- 搜索：分布式系统 CAP
- - [分布式系统的CAP定理详解](https://zhuanlan.zhihu.com/p/335617791)