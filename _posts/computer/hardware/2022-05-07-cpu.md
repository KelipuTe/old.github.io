---
title: "CPU（中央处理器）"
create_date: 2022-05-06 08:00:00 +0800
date: 2022-05-07 08:00:00 +0800
tags: hardware
comment: false
show_author_profile: true
show_subscribe: false
---

### 算术逻辑单元

Arithmetic and Logic Unit（ALU，算术逻辑单元）计算机里负责运算的组件，基本其它所有的部件都用到它。ALU 有两个单元，一个 arithmetic unit（算术单元），一个 logic unit（逻辑单元）。

英特尔 74181 是第一个封装在单个芯片内的完整 ALU，发布于 1970 年。

ALU 一般支持：add（加法）、add with carry（带进位的加法）、subtract（减法）、subtract with borrow（带借位的减法）、negate（取消）、increment（增量、+1）、decrement（减量、-1）、pass through（数字无改变通过），8 个操作。简单的 ALU 没有乘法和除法，乘法就是多次加法。高级的 ALU 有专门做乘法的算术单元。

#### 算术单元

算术单元负责计算机里所有的数字操作。

half adder（半加器）可以实现 1 + 1 以内的加法。输入 2 个二进制数，输出进位和总和。

| 输入 | 进位 | 总和 |
| --- | --- | --- |
| 0 + 0 | 0 | 0 |
| 0 + 1 | 0 | 1 |
| 1 + 0 | 0 | 1 |
| 1 + 1 | 1 | 0 |

full adder（全加器）可以处理超过 1 + 1 的运算。输入 3 个二进制数，输出进位和总和。

| 输入 | 半加器 1 | 半加器 2 | 或门 | 进位 | 总和 |
| --- | --- | --- | --- | --- | --- |
| 0 + 0 + 0 | 0 + 0 = 00 , 剩 0 | 0 + 0 = 00 | 0 \| 0 = 0 , 0 | 0 | 0 |
| 1 + 0 + 0 | 1 + 0 = 01 , 剩 0 | 1 + 0 = 01 | 0 \| 0 = 0 , 1 | 0 | 1 |
| 0 + 1 + 0 | 0 + 1 = 01 , 剩 0 | 1 + 0 = 01 | 0 \| 0 = 0 , 1 | 0 | 1 |
| 0 + 0 + 1 | 0 + 0 = 00 , 剩 1 | 0 + 1 = 01 | 0 \| 0 = 0 , 1 | 0 | 1 |
| 1 + 1 + 0 | 1 + 1 = 10 , 剩 0 | 0 + 0 = 00 | 1 \| 0 = 1 , 0 | 1 | 0 |
| 1 + 0 + 1 | 1 + 0 = 01 , 剩 1 | 1 + 1 = 10 | 0 \| 1 = 1 , 0 | 1 | 0 |
| 0 + 1 + 1 | 0 + 1 = 01 , 剩 1 | 1 + 1 = 10 | 0 \| 1 = 1 , 0 | 1 | 0 |
| 1 + 1 + 1 | 1 + 1 = 10 , 剩 1 | 0 + 1 = 01 | 1 \| 0 = 1 , 1 | 1 | 1 |

8-bit ripple carry adder（8 位行波进位加法器），可以处理两个 8 bit 的数字的加法运算。8 位行波进位加法器会输出 9 位结果，1 个进位和 8 个总和，进位如果是 1，则表示两个数之和大于 8 位能表示的最大数，求和结果（overflow）溢出。

现代计算机用的是 carry look ahead adder（超前进位加法器），电路有所不同，速度更快。

#### 逻辑单元

逻辑单元由大量的逻辑门组成，主要用于判断。

算术逻辑单元需要 3 个输入：2 个数据输入，1 个操作代码输入，操作代码表示 ALU 要做什么操作。

算术逻辑单元有多个输出，1 个数据输出；1 堆 flag（标志）输出，如：OVERFLOW（溢出标志）、ZERO（零测试电路）、NEGATIVE（负标志）。ALU还有其他的标志，这 3 个是普遍使用的。

- 加法器的进位连接到溢出标志，如果溢出标志输出true，表示有溢出。
- 计算 A-B 时，零测试电路输出 true，表示 A 和 B 相等。
- 计算 A-B 时，负标志输出 true，表示 A 小于 B。

### 位宽

32-bit（32 位）或 64-bit（64 位）计算机表示，在处理数据时，被 CPU 一块块处理的数据，每块的大小是 32 位或 64 位。