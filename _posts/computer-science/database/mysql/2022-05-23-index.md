---
title: "计算机科学--数据库--MySQL--Index（索引）"
create_date: 2022-05-23 08:00:00 +0800
date: 2022-05-23 08:00:00 +0800
tags: computer-science database mysql
comment: false
show_author_profile: true
show_subscribe: false
---

### 索引

索引是一个文件，它是要占据物理空间的。

索引分为聚簇索引（主键索引）和非聚簇索引（二级索引）。

- 对主键字段建立的索引是聚簇索引，主键索引只有一个
- 聚簇索引的叶子结点存放的是实际数据，也就是用户记录
- 对普通字段建立的索引是二级索引，二级索引可以创建多个
- 二级索引的叶子结点存放的不是实际数据，而是主键值

每个索引都是一颗 B+ 树。

#### 回表

如果某个查询语句使用了二级索引，但是查询的数据是整行数据，这时在二级索引找到主键后，需要回到聚簇索引中获得用户记录。整个查询过程需要查两棵索引树。

#### 索引覆盖

如果某个查询语句使用了二级索引，而且查询的数据就是主键或者索引字段，这时在二级索引找到主键后，就不需要回到聚簇索引中获得用户记录了，因为二级索引中已经存储了主键的值和索引字段的值。整个查询过程只查了一棵索引树。

索引覆盖的条件一般索引和联合索引都适用。

### 索引类型

主键索引: 数据列不允许重复，不允许为 NULL，一个表只能有一个主键。

唯一索引: 数据列不允许重复，允许为 NULL 值，一个表允许多个列创建唯一索引。唯一索引可以是一列的也可以是多列的

普通索引: 
基本的索引类型，没有唯一性的限制，允许为 NULL 值。

### 联合索引

联合索引（组合索引）：多个普通字段组合在一起创建的索引。

创建联合索引的时候会创建多个索引，如创建联合索引 (a,b,c) 的时候会创建 (a)、(a,b)、(a,b,c) 三个索引。

使用联合索引需要遵循最左匹配原则。

### B+ 树

MySQL 的数据和索引都是保存到硬盘上的，所以索引结构在能尽可能少的硬盘 IO 的次数的前提下，还需要能支持高效的查询某条记录和高效的进行范围查找。

- 支持高效的查询某条记录的结构有：数组、平衡二叉树、红黑树、跳表、B 树、B+ 树等。
- 支持高效的进行范围查找的结构有：数组、链表、跳表、B 树、B+ 树等。

两个要求同时符合的有数组、跳表、B 树、B+ 树。

数组和跳表都有一个问题，它们都需要整个存在内存里才能实现比较好的效果，而数据库的应用场景不可能把整个索引结构存在内存里。

B 树的问题在于：1、插入和删除的时候可能需要移动结点，B+ 树可以不移动。2、范围查询的时候使用中序遍历访问的的结点数量比 B+ 树叶子结点的双向链表结构访问的结点数量多。